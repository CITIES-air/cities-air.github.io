"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[538],{8124:(t,e,r)=>{r.d(e,{Z:()=>p});var n=r(1889),i=r(697),s=r(890),a=r(6314),o=r(7047),l=r(9530),c=r(3085),u=r(9388),d=r(4011),h=r(5445),m=r(3511),v=r(9408),f=r(184);const x=t=>{var e,r,n,i,a;let{sensorData:o,isScreen:l}=t;return l&&o.current.sensor_status===d.vI.active?null:(0,f.jsxs)(s.Z,{variant:l?"h6":"caption",sx:{mt:0,fontWeight:l&&"500 !important"},children:[(null===(e=o.current)||void 0===e?void 0:e.sensor_status)!==d.vI.active&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(u.Z,{sx:{"& *":{color:"".concat(m.Z[3].lightThemeColor," !important")},mr:.5}}),"Offline.\xa0"]}),"Last update:",null!==(r=o.current)&&void 0!==r&&r.timestamp||null!==(n=o.sensor)&&void 0!==n&&n.last_seen?" ".concat((0,d.Zj)((null===(i=o.current)||void 0===i?void 0:i.timestamp)||(null===(a=o.sensor)||void 0===a?void 0:a.last_seen))," ago"):"--"]})},p=t=>{const{currentSensorsData:e,temperatureUnitPreference:r,isScreen:u=!0}=t;return(0,f.jsx)(n.ZP,{container:!0,justifyContent:"center",sx:{"& .MuiSvgIcon-root":{verticalAlign:"sub",fontSize:u?null:"1rem"},"& *":{fontWeight:"500"},"& .condensedFont":{fontFamily:"IBM Plex Sans Condensed, sans-serif !important","& *":{fontFamily:"IBM Plex Sans Condensed, sans-serif !important"}}},children:e?Object.entries(e).map(((t,a)=>{var o,m,p,g,j,Z,y,S,b,w,I,q,C;let[_,k]=t;return(0,f.jsxs)(n.ZP,{item:!0,...(M=Object.keys(e).length,{xs:Math.max(12/M,6),sm:Math.max(12/M,4),lg:u?12/M:Math.min(5,Math.max(12/M,2))}),sx:(null===(o=k.current)||void 0===o?void 0:o.sensor_status)!==d.vI.active&&{"& *":{color:"".concat(v.Z.universal.palette.inactiveSensor)}},children:[(0,f.jsxs)(i.Z,{sx:{"& *":{color:null===(m=k.current)||void 0===m?void 0:m.color}},children:[(0,f.jsx)(s.Z,{variant:u?"h4":"h5",fontWeight:"500",className:"condensedFont",children:(null===(p=k.sensor)||void 0===p?void 0:p.location_long)||(null===(g=k.sensor)||void 0===g?void 0:g.location_short)||"No Location Name"}),(0,f.jsx)(s.Z,{variant:u?"h1":"h2",fontWeight:"500",lineHeight:u?.8:.9,children:(null===(j=k.current)||void 0===j?void 0:j.aqi)||"--"}),(0,f.jsx)(s.Z,{variant:u?"h4":"h5",fontWeight:"500",className:"condensedFont",children:(null===(Z=k.current)||void 0===Z?void 0:Z.category)||"--"})]}),(0,f.jsxs)(i.Z,{sx:{"& *":{color:u?(null===(y=k.current)||void 0===y?void 0:y.sensor_status)===d.vI.active?"#c8dcff":v.Z.universal.palette.inactiveSensor:"text.secondary"},mt:u?2:1},className:"condensedFont",children:[(0,f.jsxs)(s.Z,{variant:u?"h6":"body1",children:[(0,f.jsx)(l.Z,{}),(0,h.Lo)({rawTemp:null===(S=k.current)||void 0===S?void 0:S.temperature,currentUnit:h.fG.celsius,returnUnit:r}),"\xa0\xa0-\xa0",(0,f.jsx)(c.Z,{sx:{transform:"scaleX(0.9)"}}),null!==(b=k.current)&&void 0!==b&&b.rel_humidity?Math.round(null===(w=k.current)||void 0===w?void 0:w.rel_humidity):"--","%"]}),["outdoors","indoors_gym"].includes(null===(I=k.sensor)||void 0===I?void 0:I.location_type)&&(0,f.jsx)(s.Z,{variant:u?"body1":"body2",sx:{fontWeight:"300 !important"},children:(0,h.qu)({rawTemp:null===(q=k.current)||void 0===q?void 0:q.temperature,currentUnit:h.fG.celsius,rel_humidity:null===(C=k.current)||void 0===C?void 0:C.rel_humidity,returnUnit:r})}),x({sensorData:k,isScreen:u})]}),k.sensor_status!==d.vI.active&&(0,f.jsx)(s.Z,{variant:u?"h6":"body1",className:"condensedFont",children:(0,d.Tm)(k)})]},_);var M})):(0,f.jsxs)(a.Z,{direction:"column",alignItems:"center",justifyContent:"center",children:[(0,f.jsx)(o.Z,{variant:"text",sx:{width:"15rem",fontSize:"2rem"}}),(0,f.jsx)(o.Z,{variant:"text",sx:{width:"5rem",fontSize:"4rem",my:-1.5}}),(0,f.jsx)(o.Z,{variant:"text",sx:{width:"10rem",fontSize:"2rem"}}),(0,f.jsx)(o.Z,{variant:"text",sx:{width:"7.5rem",fontSize:"1rem"}}),(0,f.jsx)(o.Z,{variant:"text",sx:{width:"7.5rem",fontSize:"1rem"}})]})})}},6538:(t,e,r)=>{r.r(e),r.d(e,{default:()=>w});var n=r(2791),i=r(7689),s=r(1781),a=r(4852),o=r(9900),l=r(890),c=r(1889),u=r(6314),d=r(697),h=r(493),m=r(6274),v=r(4011),f=(r(5445),r(9019)),x=r(2377),p=r(3511),g=r(9408),j=r(184);const Z=t=>{const{data:e}=t,[r,i]=(0,n.useState)(!0),s=(0,n.useRef)(),a=(0,n.useRef)(),o=(0,n.useRef)(),l=(0,n.useRef)(),c=(0,n.useRef)();let u,h,m,Z,y,S=200;const b=30,w=80,I=70,q=f.jvg().x((function(t){return Z(t.timestamp)})).y((function(t){return y(t.aqi)})).curve(f.YY7.tension(0));return(0,n.useEffect)((()=>{if(!e)return;if(!s.current)return;if(!a.current)return;if(!o.current)return;if(!l.current)return;if(!c.current)return;u=f.Ys(s.current),h=s.current.clientWidth,m=s.current.clientHeight-b,f.Ys(a.current).selectAll("*").remove(),f.Ys(o.current).selectAll("*").remove(),f.Ys(l.current).selectAll("*").remove(),f.Ys(c.current).selectAll("*").remove(),f.Ys(a.current).attr("opacity",.5),f.Ys(o.current).attr("filter","brightness(0.8) contrast(1.2) saturate(1.2)"),Object.entries(e).forEach((t=>{var e;let[r,n]=t;if(null===(e=n.historical)||void 0===e||e.forEach((function(t){t.timestamp=new Date(t.timestamp),t.aqi=(0,x.Z)(t["pm2.5"]).aqi})),n.historical&&Array.isArray(n.historical)){const t=f.Fp7(n.historical,(function(t){return t.aqi}));t>S&&(S=t)}})),S=50*Math.ceil(S/50);for(let e of p.Z)if(S>=e.aqiUS.low&&S<=e.aqiUS.high){S=e.aqiUS.high;break}let t=new Date,r=new Date;r.setHours(r.getHours()-6),Z=f.Xf().domain([r,t]).rangeRound([I,h-w]),y=f.BYU().domain([0,S]).range([m+b,b]);let n=Math.floor((p.Z[1].aqiUS.high-p.Z[0].aqiUS.high)/S*m/2),i=Math.floor(n/5);for(let e=0;e<p.Z.length;e++){const t=p.Z[e];if(S<=t.aqiUS.low)break;const r=50*Math.ceil((t.aqiUS.high-t.aqiUS.low)/50);f.Ys(a.current).append("rect").attr("x",0).attr("y",m-t.aqiUS.high/S*m+b).attr("width",h).attr("height",r/S*m).attr("fill",t.lightThemeColor),f.Ys(o.current).append("text").attr("x",i).attr("y",m-t.aqiUS.low/S*m-3.5*i+b).attr("fill",t.lightThemeColor).attr("font-size",n).text(50*Math.floor(t.aqiUS.low/50)),f.Ys(o.current).append("text").attr("class","category-text-graph-sm").attr("x",i+2).attr("y",m-t.aqiUS.low/S*m-i+b).attr("fill",t.lightThemeColor).attr("font-size",n/2).text(t.category)}f.Ys(l.current).append("rect").attr("x",0).attr("y",0).attr("width",h).attr("height",b).attr("fill","white");let d=f.i$Z("%H:%M");f.Ys(l.current).append("g").attr("transform","translate(0,".concat(b,")")).call(f.F5q(Z).tickSize(-m).ticks(f.Z_i.every(120)).tickFormat((function(t){return d(t)}))).attr("font-size",n/2.25).attr("color",g.Z.universal.palette.inactiveSensor).select(".domain").remove(),f.Ys(l.current).selectAll("line").attr("stroke","white").attr("stroke-width",2).attr("opacity",.5),Object.entries(e).forEach((t=>{var e,r,i;let[s,a]=t;f.Ys(c.current).append("path").datum(a.historical||[]).attr("x",I).attr("class","line").attr("d",q).attr("fill","transparent").attr("stroke","black").attr("stroke-width","5px").attr("opacity","outdoors"===(null===(e=a.sensor)||void 0===e?void 0:e.location_type)?1:.5);const o=(null===(r=a.historical)||void 0===r?void 0:r.length)>0?null===(i=a.historical)||void 0===i?void 0:i[0]:null;if(o){var l,u,d,h;const t=p.Z[(0,x.Z)(o["pm2.5"]).aqi_category_index],e=f.Ys(c.current).append("g").attr("transform","translate("+Z(o.timestamp)+","+y(o.aqi)+")").attr("fill",(null===(l=a.current)||void 0===l?void 0:l.sensor_status)===v.vI.active?t.lightThemeColor:g.Z.universal.palette.inactiveSensor);(null===(u=a.current)||void 0===u?void 0:u.sensor_status)===v.vI.active&&e.append("circle").attr("cx",0).attr("cy",0).attr("filter","brightness(0.5)").attr("class","pulse-ring").attr("r",25),e.append("circle").attr("cx",0).attr("cy",0).attr("stroke","#666").attr("class",(null===(d=a.current)||void 0===d?void 0:d.sensor_status)===v.vI.active&&"pulse-dot").attr("r",10),e.append("text").attr("class","location-label").attr("x",15).attr("y",0).attr("fill","black").attr("alignment-baseline","middle").attr("text-anchor","left").attr("font-size",n/3).text((0,v.KN)(null===(h=a.sensor)||void 0===h?void 0:h.location_short));const r=document.getElementsByClassName("location-label");for(let n=1;n<r.length;n++){const t=r[n-1],e=r[n],i=(0,v.Pk)(t.getBoundingClientRect(),e.getBoundingClientRect());0!==i&&(t.setAttribute("y",10*i),e.setAttribute("y",10*-i))}}}))}),[e]),(0,j.jsx)(d.Z,{sx:{"& .pulse-ring":{animation:"pulse-ring 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite","@keyframes pulse-ring":{"0%":{transform:"scale(0.2)"},"80%":{},"100%":{opacity:0}}},"& .pulse-dot":{animation:"pulse-dot 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite","@keyframes pulse-dot":{"0%":{transform:"scale(0.5)"},"50%":{transform:"scale(1)",filter:"brightness(1.2) contrast(1.2) saturate(1.2)"},"100%":{transform:"scale(0.5)"}}}},width:"100%",height:"100%",children:(0,j.jsxs)("svg",{id:"recent-historical-graph",width:"100%",height:"100%",ref:s,children:[(0,j.jsx)("g",{ref:a}),(0,j.jsx)("g",{ref:l}),(0,j.jsx)("g",{ref:o}),(0,j.jsx)("g",{ref:c})]})})};var y=r(925),S=r(8124),b=r(8206);const w=t=>{let{title:e,temperatureUnitPreference:r}=t;const{user:f}=(0,n.useContext)(s.S),x=(0,i.s0)();(0,n.useEffect)((()=>{document.title=e}),[e]);const[w,I]=(0,n.useState)(),[q,C]=(0,n.useState)({});(0,n.useEffect)((()=>{function t(){return 0!==[0,0,1,1,0,0,1,1,0,0,1,1][(new Date).getMonth()]}I(t());const e=setInterval((()=>{I(t())}),864e5);return()=>{clearInterval(e)}}),[]),(0,n.useEffect)((()=>{const t=(0,b.kG)({endpoint:b.Cq.screen});if(!t)return;(0,b.mQ)(t).then((t=>{C(t)})).catch((t=>{console.log(t),x("/login")}));const e=setInterval((()=>{(0,b.mQ)(t).then((t=>{C(t)})).catch((t=>console.log(t)))}),3e5);return()=>{clearInterval(e)}}),[]);const _=()=>{if(!Object.values(q).every((t=>{var e;return(null===(e=t.current)||void 0===e?void 0:e.sensor_status)===v.vI.active})))return null;let t,e;for(let s=0;s<Object.values(q).length;s++){var r;const n=Object.values(q)[s];if("outdoors"===(null===(r=n.sensor)||void 0===r?void 0:r.location_type)){if(t=n.current.aqi,t<=p.Z[0].aqiUS.high)return null}else e=n.current.aqi}const n=t/e;let i;if(n>=2)i="".concat(parseFloat(n).toFixed(1)," times");else{if(!(n>1.2))return null;i="".concat(Math.round((t-e)/e*100),"%")}return(0,j.jsx)(a.ZP,{children:(0,j.jsx)(o.Z,{primary:(0,j.jsxs)(j.Fragment,{children:["Indoors air is",(0,j.jsx)(l.Z,{component:"span",color:"".concat(p.Z[0].lightThemeColor," !important"),children:" ".concat(i," ")}),"better than outdoors"]})})})};return(0,j.jsxs)(c.ZP,{container:!0,alignContent:"stretch",alignItems:"stretch",height:"100vh",sx:{overflow:"hidden",background:"white","& *":{fontWeight:"500 !important"},"& .condensedFont":{fontFamily:"IBM Plex Sans Condensed, sans-serif !important","& *":{fontFamily:"IBM Plex Sans Condensed, sans-serif !important"}},"& .flashingRed":{"& .MuiTypography-root ":{color:"".concat(p.Z[3].lightThemeColor," !important"),opacity:.8},color:"".concat(p.Z[3].lightThemeColor," !important"),animation:"flashingRed 3s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite","@keyframes flashingRed":{"0%":{opacity:1},"50%":{opacity:.5},"100%":{opacity:1}}}},children:[(0,j.jsx)(c.ZP,{item:!0,xs:6,sx:{py:3,px:2,order:w?1:0,background:"#212529"},children:(0,j.jsxs)(u.Z,{direction:"column",justifyContent:"space-between",height:"100%",textAlign:"center",children:[(0,j.jsxs)(d.Z,{children:[(0,j.jsx)(l.Z,{variant:"h4",fontWeight:"500",color:"white",children:"PM2.5 AIR QUALITY INDEX"}),(0,j.jsx)(l.Z,{variant:"h5",className:"condensedFont",color:g.Z.universal.palette.inactiveSensor,children:"Particulate Matter < 2.5\u03bcm"})]}),(0,j.jsx)(c.ZP,{container:!0,justifyContent:"space-around",children:(0,j.jsx)(S.Z,{currentSensorsData:q,temperatureUnitPreference:r})}),(0,j.jsxs)(h.Z,{className:"condensedFont",sx:{listStyleType:"disclosure-closed","& .MuiTypography-root":{fontSize:"1.5rem"},"& .MuiListItem-root":{display:"list-item",ml:3,p:0,pr:3},"& .MuiTypography-root, .MuiListItem-root":{color:g.Z.universal.palette.inactiveSensor}},children:[(0,j.jsx)(_,{}),Object.entries(q).map((t=>{var e,r,n;let[i,s]=t;return(null===(e=s.current)||void 0===e?void 0:e.healthSuggestion)&&(0,j.jsx)(a.ZP,{className:(null===(r=s.current)||void 0===r?void 0:r.aqi)>=p.Z[2].aqiUS.low&&"flashingRed",children:(0,j.jsx)(o.Z,{primary:null===(n=s.current)||void 0===n?void 0:n.healthSuggestion})},i)}))]})]})}),(0,j.jsxs)(c.ZP,{item:!0,xs:6,sx:{order:w?0:1},children:[(0,j.jsx)(d.Z,{sx:{position:"absolute",top:0,right:!w&&0,left:w&&0,width:"5vw",height:"5vw",m:1},children:(0,j.jsx)(m.Z,{})}),(0,j.jsxs)(c.ZP,{container:!0,alignContent:"space-between",justifyContent:"center",height:"100%",textAlign:"center",children:[(0,j.jsx)(c.ZP,{item:!0,xs:12,sx:{pt:3,px:2},children:(0,j.jsx)(l.Z,{variant:"h4",fontWeight:"500",sx:{color:"black"},children:"AN INITIATIVE BY CITIESair"})}),(0,j.jsx)(c.ZP,{item:!0,xs:2,children:(0,j.jsx)(d.Z,{height:"auto",width:"100%",children:(0,j.jsx)(y.ZP,{size:256,style:{height:"auto",maxWidth:"100%",width:"100%"},value:"".concat((0,v.p7)(document.location.href),"?source=").concat((0,v.c9)(document.location.href)),viewBox:"0 0 256 256"})})}),(0,j.jsx)(c.ZP,{item:!0,xs:12,height:"70%",className:"condensedFont",sx:{"& *":{fontWeight:"600 !important"}},children:(0,j.jsx)(Z,{data:q})})]})]})]})}}}]);
//# sourceMappingURL=538.c2512806.chunk.js.map